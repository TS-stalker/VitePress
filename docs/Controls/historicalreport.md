## 一、概述

历史报表控件用于将变量数据以表格、图表等可视化形式进行集中展示和分析，支持多维度数据统计和灵活格式配置，为历史数据回顾、性能分析和决策支持提供专业的数据呈现工具。

![图片描述](../images/控件照片/历史报表/1.png)

## 二、使用场景

历史报表控件在以下场景中使用：

### 1.数据统计场景

- 当需要对历史数据进行多维度统计和可视化展示时
- 生产数据统计报表、设备运行效率分析、能耗统计分析
- 质量指标统计、工艺参数趋势汇总

## 三、快速开始

### 1.设计阶段配置

- 拖拽历史报表控件至画布，调整其位置与大小。
- 配置基本外观属性：如背景、是否显示图例，以及是否启用暗黑模式。

### 2.运行时操作

- **查看报表**：直接浏览并查看在“数据分析-报表设计”中预先配置好的所有历史报表及其数据。
- **新建报表**：在运行时可根据需要，新增并配置需观察数据的历史报表。
- **修改报表**：对已存在的历史报表进行编辑和参数调整。
- **数据导出**：将当前报表的查询结果导出为常见文件格式（如Excel）。
- **数据筛选**：通过选择不同的时间展示形式（如年、月、日、自定义范围）对数据进行筛选，并可一键重置所有的数据。

### **示例：**

**1.数据统计场景：**

1.1 数据统计场景示例

该示例是创建月度生产数据报表。绑定产品产量、能耗等关键变量，设置时间频率为每日统计，展示各指标的日变化趋势和月度汇总数据，通过饼图显示各产品线产量占比。如图1-1所示。

![图片描述](../images/控件照片/历史报表/2.gif)

图 1-1

1.2 实际组态教程：

1. 拖拽历史报表控件到画布并调整位置尺寸
2. 配置报表基本外观属性：如背景、是否显示图例，以及是否启用暗黑模式。
3. 保存进入运行时，可以查看到“数据分析-报表设计”中预先配置好的所有历史报表及其数据
4. 新建历史报表，设置采样方式为原始值，时间范围为最近一天，绑定变量数据
5. 可以点击下方的表格中导出，将数据导出Excel查看

## 四、属性详解

| 名称     | 描述                                |
| -------- | ----------------------------------- |
| 名字     | 此控件的名称。                      |
| X        | 控件左侧距画布左侧的距离，单位px。  |
| Y        | 控件顶部距画布顶部的距离，单位px。  |
| W        | 控件的宽度，单位px。                |
| H        | 控件的高度，单位px。                |
| 背景     | 报表的背景色                        |
| 图例     | 报表中饼状图和折线图的图裂显示/隐藏 |
| 暗黑模式 | 报表的暗黑模式的开启                |
