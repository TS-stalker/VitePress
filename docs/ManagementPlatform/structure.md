## 一、概述

设备管理模块负责对接物理世界的设备资产，通过数字化的方式进行建模、配置与数据接入。它采用分层设计，依次管理**设备类型、设备点表、设备**，最终自动生成可用的**设备变量**，构成完整的设备数据链路。

## 二、核心功能模块

### 1. 设备类型

**设备类型**是设备管理的顶层分类，用于定义一类具有相同特性的设备模板。

- **功能**：创建不同种类的设备模型（如：“水泵”、“风机”、“智能电表”）。
- **可编辑属性**：属性注解**Code**该设备类型的唯一编码。**名称**该设备类型的显示名称。**注释**对此类型设备的说明。**点表规范**定义该类设备应遵循的通信**协议规范**（如：Modbus、OPC UA）。**分类**设备的大类归属（如：动力设备、环境设备）。**上一次修改**记录最后修改时间。

![图片描述](../images/ManagementPlatform/设备管理1.png)

### 2. 设备点表

**设备点表**是在选定一个具体的**设备类型**后，对该类型设备所有可访问的**数据点（寄存器）** 进行定义。

- **功能**：为标准设备类型配置其具体的数据结构。
- **可编辑属性（关键项）**：

  - **Code/名称/注释**：数据点的标识、名称和说明。
  - **源/数据类型/长度/偏移量/偏移位**：定义该数据点在协议中的**地址、数据类型和读取规则**。
  - **单位**：数据点的计量单位。
  - **分类/数据转换/转换脚本**：

    - **数据转换**：勾选后，可对读取的原始值应用脚本进行二次处理。
    - **转换脚本**：双击可进入脚本编辑器，编写自定义逻辑（如：线性转换、公式计算），将原始数据转换为工程值。

![图片描述](../images/ManagementPlatform/设备管理2.png)

### 3. 设备

**设备**是设备类型在项目中的具体实例，代表一台真实的物理设备。

- **功能**：创建设备实例，并配置其具体的通信参数和归属信息。
- **可编辑属性（关键项）**：

  - **Code**：设备的唯一编码。
  - **连接**：**核心设置**。从“连接管理”中创建的连接列表里，为该设备**选择正确的通信连接**（如特定的Modbus TCP连接）。
  - **起始地址/组/空间**：设备的具体地址、所属分组和物理位置。
  - **设备品牌/型号/种类/编码**：设备的物理属性信息。
  - **分类/上一次修改时间**：设备分类和修改记录。

![图片描述](../images/ManagementPlatform/设备管理3.png)

### 4. 设备变量

**设备变量**是**设备**和**设备点表**自动生成的最终产物，是可以在项目中直接绑定使用的**结构化变量**。

- **生成原理**：系统根据“设备”选择的“设备类型”及其“设备点表”，自动为每个具体设备生成一组对应的变量。
- **属性信息**：每个变量继承了设备点表的定义（如Code、单位、数据转换脚本），并关联了具体设备的实例信息（如连接、地址、设备名称、空间位置等），同时包含实时值、时间戳、数据质量等动态信息。

![图片描述](../images/ManagementPlatform/设备管理4.png)

**变量管理视图详解**

针对设备变量，系统提供了四个专业视图进行精细化管理，分别用于展示不同维度的信息并配置相应的功能。下表详细说明了每个视图的核心功能与作用：

| 视图名称 | 核心功能                                                   | 关键配置项                                                                                                                                                                                                                          | 特点与注意事项                                                                                                                                                                                                            |
| -------- | ---------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 主视图   | 展示和管理变量的基本属性与实时信息。                       | •基本属性：变量名称、注释、数据类型、长度、单位、所属组等。•连接信息：数据源、连接、地址、关联设备。•设备信息：空间位置、设备品牌、型号、种类、名称、编码。•实时数据：当前值、时间戳、数据质量码。•数据转换：可开启并编写转换脚本。 | 注意：若需对原始值进行特殊处理（如单位换算、公式计算、范围映射），可开启“数据转换”功能，在“转换脚本”编辑器中编写JavaScript脚本，实现数据预处理。                                                                          |
| 报警视图 | 配置和管理变量的报警条件与策略。                           | •报警类型：-布尔型：开关报警。-数值型：上限、下限、上上限、下下限报警。•报警参数：报警值、报警描述、报警等级。•高级设置：延迟报警、恢复延迟。                                                                                       | 重要特性：启用“延迟报警”后，只有当报警状态持续超过设置的延迟时间，才会正式触发报警。在此期间若状态恢复，则视为瞬时干扰，不予记录。这能有效过滤瞬时波动，避免误报。                                                        |
| 归档视图 | 配置变量的历史数据存储策略，将关键数据记录到历史库。       | •归档模式：1.定时记录：设置起始时间与固定时间间隔（如：每5分钟记录一次）。2.变化记录：仅当变量的值发生变化（超出死区）时才记录。•归档策略：存储周期、压缩策略、存储位置。                                                           | 应用场景：定时记录用于生成趋势报表；变化记录用于追踪关键操作或状态切换，节省存储空间。配置后，数据将持久化，供历史趋势图、报表和历史检索使用。                                                                            |
| 事件视图 | 配置基于变量值变化触发的事件记录，用于关键动作追踪与审计。 | •事件类型：-数值型：赋值事件（值被改变）。-布尔型：开事件（false→true）、关事件（true→false）。•事件参数：事件触发条件、事件描述。                                                                                                  | 核心价值：不同于归档记录所有值，事件视图专注于记录有业务意义的状态跳变。例如，记录设备的每一次启停（开/关事件）或关键参数的设定值修改（赋值事件）。记录的事件可在“事件列表”控件中查看，便于操作追溯、故障分析和合规审计。 |

通过这四个视图，您可以从不同维度对设备变量进行全方位管理：在**主视图**中定义其身份和实时状态；在**报警视图**中设定安全边界；在**归档视图**中规划其历史记忆；在**事件视图**中标记其重要时刻，共同构成了变量从产生、监控到分析的全生命周期管理体系。

## 三、工作流总结

标准的设备接入流程为：**定义设备类型 → 配置设备点表 → 创建设备实例（选择连接）→ 自动生成设备变量**。通过此流程，可将物理设备无缝映射为组态系统中的标准化数据源。
